import{r as B,o as s,c as i,a2 as f,a as e,F as x,b as T,t as R,d as h,z as _,a1 as L,aI as M,b4 as U,bo as F,bp as H,M as q,W as se,aq as z,bt as V,e as K,w as W,bn as ie,bl as P,ax as ne,bs as oe}from"./index.4eed476e.js";import{_ as le,u as ae}from"./address.6c62e9c3.js";import{u as J}from"./service.09a51995.js";const ce={class:"row-item d-f-center"},re={key:0},de={class:"row-item__inner d-f-center w-100"},ue={key:0},ve={key:0},_e={key:1},me={key:2},pe={key:1},fe={key:0,class:"row-item__block"},he={__name:"RowItem",props:{item:{type:Object,default(t){return{}}},itemKey:{type:Array,default:()=>[]},isActive:{type:Boolean,default:!1}},emits:["editItem","checkItem","unCheckItem"],setup(t,{emit:k}){return(r,n)=>{const c=B("Icon");return s(),i("div",ce,[t.isActive?(s(),i("span",re,[t.item.isChecked?f("",!0):(s(),i("div",{key:0,onClick:n[0]||(n[0]=o=>r.$emit("checkItem",t.item)),class:"square"})),t.item.isChecked?(s(),i("div",{key:1,onClick:n[1]||(n[1]=o=>r.$emit("unCheckItem",t.item)),class:"square square--done"})):f("",!0)])):f("",!0),e("div",de,[(s(!0),i(x,null,T(t.itemKey,o=>(s(),i("div",{class:"row-item__block",key:o},[o==="is_luxury"?(s(),i("span",ue,[t.item[o]===0?(s(),i("span",ve,"\u043E\u0431\u044B\u0447\u043D\u0430\u044F")):f("",!0),t.item[o]===1?(s(),i("span",_e,"\u043B\u044E\u043A\u0441")):f("",!0),t.item[o]===2?(s(),i("span",me,"\u0438\u0437\u043C\u0435\u043D\u044F\u0435\u043C\u0430\u044F \u0446\u0435\u043D\u0430")):f("",!0)])):(s(),i("span",pe,R(t.item[o]),1))]))),128)),t.isActive?f("",!0):(s(),i("div",fe,[e("button",{class:"btn btn--icon",onClick:n[2]||(n[2]=o=>r.$emit("editItem"))},[h(c,{class:"text-blue",id:"pencil"})])]))])])}}};const ye=["onKeydown"],we={class:"popup__inner d-f-center column align-start"},ke={__name:"PopUp",props:{popUpClass:{type:String,default:""}},setup(t,{expose:k}){const r=_(!1),n=_(),c=async a=>{var l;r.value=!0,await z(),n.value.focus();const u=(l=n.value)==null?void 0:l.querySelectorAll("input");u.length===1&&u[0].focus()},o=()=>{r.value=!1};return k({show:c,hide:o,open:r}),(a,u)=>(s(),L(se,{to:"#app"},[r.value?(s(),i("div",{key:0,onKeydown:H(o,["esc"]),tabindex:"0",ref_key:"popUp",ref:n,class:q([t.popUpClass,"popup d-f-center justify-center"])},[e("div",we,[M(a.$slots,"default")]),U(e("div",{onClick:o,class:"popup__fade"},null,512),[[F,r.value]])],42,ye)):f("",!0)]))}},ge={class:"row-item d-f-center"},$e={class:"row-item__inner d-f-center w-100"},be={key:0},Ie={key:0},Ae={key:1},Ce={key:2},Se={key:1},xe={key:0,class:"row-item__err text-red d-f-center"},Ue={key:1,class:"row-item__err text-red d-f-center"},Te={class:"row-item__block"},Ke={class:"popup__header"},Re={class:"popup__header-icon text-red"},je=e("div",{class:"popup__title"},"\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u0443\u0441\u043B\u0443\u0433\u0438",-1),Le={class:"popup__text"},Be={class:"popup__btns w-100 d-f-center justify-between"},Ne={__name:"RowItemWash",props:{item:{type:Object,default(t){return{}}},itemKey:{type:Array,default:()=>[]},isActive:{type:Boolean,default:!1},url:{type:String,default:""}},emits:["removeItem"],setup(t,{emit:k}){const r=t,n=J(),c=V(),o=_(),a=async()=>{c.isLoading=!0,await n.remove({service_id:r.item.service_id,url:r.url}),o.value.hide(),k("removeItem"),c.isLoading=!1};return(u,l)=>{const d=B("Icon");return s(),i(x,null,[e("div",ge,[e("div",$e,[(s(!0),i(x,null,T(t.itemKey,m=>(s(),i("div",{class:"row-item__block",key:m},[m==="is_luxury"?(s(),i("span",be,[t.item[m]===0?(s(),i("span",Ie,"\u043E\u0431\u044B\u0447\u043D\u0430\u044F")):f("",!0),t.item[m]===1?(s(),i("span",Ae,"\u043B\u044E\u043A\u0441")):f("",!0),t.item[m]===2?(s(),i("span",Ce,"\u0438\u0437\u043C\u0435\u043D\u044F\u0435\u043C\u0430\u044F \u0446\u0435\u043D\u0430")):f("",!0)])):(s(),i("span",Se,R(t.item[m]),1))]))),128)),t.item.isUpdated===!1?(s(),i("span",xe,[h(d,{id:"!"}),K(" \u0423\u0441\u043B\u0443\u0433\u0430 \u043D\u0435 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0430")])):t.item.isOnServer===!1?(s(),i("span",Ue,[h(d,{id:"!"}),K(" \u0423\u0441\u043B\u0443\u0433\u0438 \u043D\u0435\u0442 \u0432 \u0431\u0430\u0437\u0435 \u0434\u0430\u043D\u043D\u044B\u0445")])):f("",!0),e("div",Te,[e("button",{class:"btn btn--icon",onClick:l[0]||(l[0]=m=>o.value.show())},[h(d,{class:"text-red",id:"trash"})])])])]),h(ke,{ref_key:"removePopUp",ref:o,popUpClass:"popup--sm"},{default:W(()=>[e("div",Ke,[e("div",Re,[h(d,{id:"trash"})]),je,e("div",{role:"button",class:"popup__close",onClick:l[1]||(l[1]=m=>o.value.hide())},[h(d,{class:"x",id:"plus"})])]),e("p",Le," \u0412\u044B \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0443\u0441\u043B\u0443\u0433\u0443 "+R(t.item.description)+"? ",1),e("div",Be,[e("button",{class:"btn btn--out btn--primary popup__btn text-red",onClick:a}," \u0423\u0434\u0430\u043B\u0438\u0442\u044C "),e("button",{class:"btn btn--out btn--primary popup__btn text-blue",onClick:l[2]||(l[2]=m=>o.value.hide())}," \u041E\u0442\u043C\u0435\u043D\u0430 ")])]),_:1},512)],64)}}},Oe={class:"row-header d-f-center"},Pe={key:0},qe={class:"row-header__inner d-f-center w-100"},Ve={key:0,class:"row-header__item"},D={__name:"RowHeader",props:{titles:{type:Array,default:()=>[]},isActive:{type:Boolean,default:!1},isToggledAll:{type:Boolean,default:!1}},emits:["toggle"],setup(t,{emit:k}){return(r,n)=>(s(),i("div",Oe,[t.isActive?(s(),i("span",Pe,[t.isToggledAll?(s(),i("div",{key:0,onClick:n[0]||(n[0]=c=>r.$emit("toggle")),class:"square square--minus"})):(s(),i("div",{key:1,onClick:n[1]||(n[1]=c=>r.$emit("toggle")),class:"square"}))])):f("",!0),e("div",qe,[(s(!0),i(x,null,T(t.titles,(c,o)=>(s(),i("div",{class:"row-header__item",key:o},R(c),1))),128)),t.isActive?f("",!0):(s(),i("div",Ve,"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435"))])]))}},We={class:"row-block",id:"rowBlock"},Je={class:"row-top d-f-center justify-between"},Ee=e("div",{class:"row-title"},"\u0411\u0430\u0437\u0430 \u0434\u0430\u043D\u043D\u044B\u0445",-1),De={class:"mr8"},Me={class:"row-inner"},Fe={class:"row-items cscroll"},He={key:0,class:"row-add-btn d-f-center justify-center"},ze={class:"row-content w-100"},Ge={class:"row-top d-f-center justify-between"},Qe={class:"d-f-center"},Xe=["onClick"],Ye={key:0,class:"row-inner row-inner--empty"},Ze={key:1,class:"row-inner"},et={class:"row-items cscroll"},tt={__name:"RowBlock",props:{addTitle:{type:String,defaul:""},headerTitles:{type:Array,default:()=>[]},items:{type:Array,default:()=>[]},itemsWash:{type:Array,default:()=>[]},address:{type:Array,default:()=>[]},activeAddress:{type:String},itemKey:{type:Array,default:()=>[]},isActive:{type:Boolean,default:!1},isToggledAll:{type:Boolean,default:!1},url:{type:String,default:""}},emits:["addItem","editItem","changeAddress","removeItem","toggle","insertServices","checkItem","unCheckItem"],setup(t,{emit:k}){_(),_();const r=_();return(n,c)=>{const o=B("Icon");return s(),i("div",We,[e("div",{class:q(["row-content w-100",{"row-content--active":t.isActive}])},[e("div",Je,[Ee,e("div",{onClick:c[0]||(c[0]=a=>n.$emit("addItem")),class:"text-blue d-f-center",role:"button"},[e("span",De,R(t.addTitle),1),h(o,{id:"plus"})])]),e("div",Me,[h(D,{onToggle:c[1]||(c[1]=a=>n.$emit("toggle")),isToggledAll:t.isToggledAll,isActive:t.isActive,titles:t.headerTitles},null,8,["isToggledAll","isActive","titles"]),e("div",Fe,[(s(!0),i(x,null,T(t.items,a=>(s(),L(he,{isActive:t.isActive,onEditItem:u=>n.$emit("editItem",a.service_id),onCheckItem:u=>n.$emit("checkItem",a),onUnCheckItem:u=>n.$emit("unCheckItem",a),item:a,itemKey:t.itemKey,key:a.service_id},null,8,["isActive","onEditItem","onCheckItem","onUnCheckItem","item","itemKey"]))),128)),t.isActive?(s(),i("div",He,[e("button",{class:"btn btn--primary",onClick:c[2]||(c[2]=a=>n.$emit("insertServices"))}," \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435 \u0443\u0441\u043B\u0443\u0433\u0438 ")])):f("",!0)])])],2),e("div",ze,[e("div",Ge,[e("div",Qe,[K(" \u041C\u043E\u0439\u043A\u0430: "),h(le,{class:"row-dropdown",linkClass:"text-blue",ref_key:"dropDownRef",ref:r,title:t.activeAddress},{body:W(()=>[(s(!0),i(x,null,T(t.address,a=>(s(),i("div",{class:"dropdown__item d-f-center align-start",key:a.node_id,onClick:u=>{r.value.hide(),n.$emit("changeAddress",a)}},R(a.description),9,Xe))),128))]),_:1},8,["title"])])]),t.isActive?(s(),i("div",Ze,[h(D,{titles:t.headerTitles},null,8,["titles"]),e("div",et,[(s(!0),i(x,null,T(t.itemsWash,a=>(s(),L(Ne,{isActive:t.isActive,onRemoveItem:u=>n.$emit("removeItem",a.service_id),item:a,itemKey:t.itemKey,key:a.service_id,url:t.url},null,8,["isActive","onRemoveItem","item","itemKey","url"]))),128))])])):(s(),i("div",Ye,"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043C\u043E\u0439\u043A\u0443"))])])}}};const st=["onKeydown"],it={class:"row-modal__inner d-f-center column align-start"},nt={class:"row-modal__fade"},ot={__name:"RowPopUp",props:{popUpClass:{type:String,default:""}},setup(t,{expose:k}){const r=_(!1),n=_(),c=async a=>{var l;r.value=!0,await z(),n.value.focus();const u=(l=n.value)==null?void 0:l.querySelectorAll("input");u.length>0&&u[0].focus()},o=()=>{r.value=!1};return k({show:c,hide:o}),(a,u)=>r.value?(s(),i("div",{key:0,onKeydown:H(o,["esc"]),tabindex:"0",ref_key:"popUp",ref:n,class:q([t.popUpClass,"row-modal d-f-center justify-center"])},[e("div",it,[M(a.$slots,"default")]),U(e("div",nt,null,512),[[F,r.value]])],42,st)):f("",!0)}},lt={key:0,class:"row-modal__header d-f-center justify-between w-100"},at=e("div",{class:"row-modal__title"},"\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u043D\u043E\u0432\u043E\u0439 \u0443\u0441\u043B\u0443\u0433\u0438",-1),ct=e("span",{class:"mr8"},"\u041E\u0442\u043C\u0435\u043D\u0430",-1),rt={key:1,class:"row-modal__header d-f-center justify-between w-100"},dt=e("div",{class:"row-modal__title"},"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0443\u0441\u043B\u0443\u0433\u0438",-1),ut=e("span",{class:"mr8"},"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",-1),vt=e("span",{class:"mr8"},"\u041E\u0442\u043C\u0435\u043D\u0430",-1),_t={class:"row-modal__items w-100"},mt={class:"row-modal__item"},pt={class:"input"},ft=e("label",{for:"create"}," \u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 ",-1),ht={class:"row-modal__item"},yt={class:"radio-inputs d-f-center"},wt={class:"d-f-center justify-center",for:"simplewash"},kt=e("span",null,"\u041E\u0431\u044B\u0447\u043D\u0430\u044F \u043C\u043E\u0439\u043A\u0430",-1),gt=e("div",{class:"radio-input"},null,-1),$t={class:"d-f-center justify-center",for:"luxwash"},bt=e("span",null,"\u041B\u044E\u043A\u0441 \u043C\u043E\u0439\u043A\u0430",-1),It=e("div",{class:"radio-input"},null,-1),At={class:"d-f-center justify-center",for:"changewash"},Ct=e("span",null,"\u0418\u0437\u043C\u0435\u043D\u044F\u0435\u043C\u0430\u044F \u043C\u043E\u0439\u043A\u0430",-1),St=e("div",{class:"radio-input"},null,-1),xt={key:2,class:"row-modal__btn"},Ut={key:3,class:"row-modal__btn"},Tt={__name:"ServicePopUp",emits:["setItems"],setup(t,{expose:k,emit:r}){const n=J(),c=V(),o=_(),a=_(!1),u=_(""),l=_({description:"",is_luxury:0,service_id:""}),d=y=>{y==="create"?a.value=!0:(a.value=!1,l.value=n.getServiceById(y),u.value=y),o.value.show()},m=()=>{l.value={description:"",is_luxury:0,service_id:""},u.value="",o.value.hide()},j=async()=>{if(l.value.description.length>0){c.isLoading=!0;const y=l.value.description,w=Number(l.value.is_luxury);m(),await n.create({description:y,is_luxury:w}),await n.fetch(),r("setItems"),c.isLoading=!1}},b=async()=>{if(l.value.description.length>0){console.log(l.value.description.length),c.isLoading=!0;const y=l.value.description,w=Number(l.value.is_luxury),C=u.value;m(),await n.edit({description:y,is_luxury:w,service_id:C}),await n.fetch(),r("setItems"),c.isLoading=!1}},I=async()=>{c.isLoading=!0;const y=u.value;m(),await n.remove({service_id:y}),await n.fetch(),r("setItems"),c.isLoading=!1};return k({show:d,hide:m}),(y,w)=>{const C=B("Icon");return s(),L(ot,{ref_key:"popUpRef",ref:o},{default:W(()=>[a.value?(s(),i("div",lt,[at,e("div",{onClick:m,class:"row-modal__cancel d-f-center",role:"button"},[ct,K(),h(C,{class:"x",id:"plus"})])])):(s(),i("div",rt,[dt,e("div",{onClick:I,class:"row-modal__clear d-f-center text-red",role:"button"},[ut,K(),h(C,{id:"trash"})]),e("div",{onClick:m,class:"row-modal__cancel d-f-center",role:"button"},[vt,K(),h(C,{class:"x",id:"plus"})])])),e("div",_t,[e("div",mt,[e("div",pt,[ft,U(e("input",{"onUpdate:modelValue":w[0]||(w[0]=S=>l.value.description=S),type:"text",id:"create"},null,512),[[ie,l.value.description,void 0,{trim:!0}]])])]),e("div",ht,[e("div",yt,[e("label",wt,[kt,U(e("input",{type:"radio",name:"typewash",id:"simplewash",value:"0","onUpdate:modelValue":w[1]||(w[1]=S=>l.value.is_luxury=S)},null,512),[[P,l.value.is_luxury]]),gt]),e("label",$t,[bt,U(e("input",{"onUpdate:modelValue":w[2]||(w[2]=S=>l.value.is_luxury=S),type:"radio",name:"typewash",id:"luxwash",value:"1"},null,512),[[P,l.value.is_luxury]]),It]),e("label",At,[Ct,U(e("input",{"onUpdate:modelValue":w[3]||(w[3]=S=>l.value.is_luxury=S),type:"radio",name:"typewash",id:"changewash",value:"2"},null,512),[[P,l.value.is_luxury]]),St])])])]),a.value?(s(),i("div",xt,[e("button",{onClick:j,class:"btn btn--primary"},"\u0413\u043E\u0442\u043E\u0432\u043E")])):(s(),i("div",Ut,[e("button",{onClick:b,class:"btn btn--primary"},"\u0413\u043E\u0442\u043E\u0432\u043E")]))]),_:1},512)}}},Kt=e("div",{class:"toggle d-none"},[e("input",{type:"checkbox",id:"switch"}),e("label",{for:"switch"},"Toggle")],-1),Rt={class:"services"},jt={key:0,class:"container"},Ot={__name:"ServicesView",setup(t){const k=["\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u0443\u0441\u043B\u0443\u0433\u0438","\u0422\u0438\u043F"],r=["description","is_luxury"],n=ae(),c=J(),o=V(),a=_(!1),u=_([]),l=_("\u0412\u044B\u0431\u0440\u0430\u0442\u044C"),d=_([]),m=_([]),j=_(!1),b=_(0),I=_(!1),y=_("");ne(async()=>{o.isLoading=!0,await c.fetch(),await n.fetch(),C(),u.value=JSON.parse(JSON.stringify(n.address)),u.value.pop(),a.value=!0,o.isLoading=!1});const w=_(),C=()=>{d.value=JSON.parse(JSON.stringify(c.services))},S=()=>{E("create")},G=v=>{E(v)},E=v=>{w.value.show(v)},Q=()=>{if(I.value===!0){for(let v=0;v<d.value.length;v++){const g=d.value[v];g.isChecked=!1}I.value=!1,b.value=0}else{I.value=!0;for(let v=0;v<d.value.length;v++){const g=d.value[v];g.isChecked=!0}b.value=d.value.length}},N=async()=>{const v={method:"GET",url:y.value+"/service/get"},{data:{data:{info:g}}}=await oe(v);for(let $=0;$<d.value.length;$++){const p=d.value[$];g.find(A=>A.service_id===p.service_id)?(p.isChecked=!0,b.value+=1):p.isChecked=!1}for(let $=0;$<g.length;$++){const p=g[$];d.value.find(A=>A.service_id===p.service_id)?p.isOnServer=!0:p.isOnServer=!1;for(let A=0;A<d.value.length;A++){const O=d.value[A];p.isOnServer&&O.service_id===p.service_id&&(O.description===p.description&&O.is_luxury===p.is_luxury?p.isUpdated=!0:p.isUpdated=!1)}}b.value===d.value.length&&(I.value=!0),m.value=g},X=async v=>{o.isLoading=!0,j.value=!0,I.value=!1,C(),b.value=0,l.value=v.description,y.value=v.url,await N(),o.isLoading=!1},Y=async v=>{o.isLoading=!0;const g=[],$=JSON.parse(JSON.stringify(d.value));for(let p=0;p<$.length;p++){$[p].description=encodeURIComponent($[p].description);const A=$[p];A.isChecked&&g.push(A)}await c.insert({url:y.value+"/service/insert",services:g}),await N(),o.isLoading=!1},Z=v=>{v.isChecked=!0,b.value+=1,b.value===d.value.length&&(I.value=!0)},ee=v=>{v.isChecked=!1,b.value-=1,b.value!==d.value.length&&(I.value=!1)},te=()=>{N(),I.value=!1};return(v,g)=>(s(),i(x,null,[Kt,e("div",Rt,[a.value?(s(),i("div",jt,[h(tt,{class:"services__inner",headerTitles:k,itemKey:r,isActive:j.value,addTitle:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0443\u0441\u043B\u0443\u0433\u0443",items:d.value,itemsWash:m.value,onAddItem:S,onEditItem:G,onCheckItem:Z,onUnCheckItem:ee,onChangeAddress:X,onToggle:Q,address:u.value,activeAddress:l.value,isToggledAll:I.value,onInsertServices:Y,onRemoveItem:te,url:y.value},null,8,["isActive","items","itemsWash","address","activeAddress","isToggledAll","url"]),h(Tt,{onSetItems:C,ref_key:"ServicePopUpRef",ref:w},null,512)])):f("",!0)])],64))}};export{Ot as default};
